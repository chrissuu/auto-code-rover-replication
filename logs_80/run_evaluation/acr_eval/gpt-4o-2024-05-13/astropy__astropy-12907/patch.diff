diff --git a/astropy/modeling/separable.py b/astropy/modeling/separable.py
index a308e2729..cf876d49a 100644
--- a/astropy/modeling/separable.py
+++ b/astropy/modeling/separable.py
@@ -216,7 +216,7 @@ def _coord_matrix(model, pos, noutp):
     return mat
 
 
-def _cstack(left, right):
+def _cstack(left, right, noutp=None):
     """
     Function corresponding to '&' operation.
 
@@ -224,6 +224,8 @@ def _cstack(left, right):
     ----------
     left, right : `astropy.modeling.Model` or ndarray
         If input is of an array, it is the output of `coord_matrix`.
+    noutp : int, optional
+        Number of outputs of the compound model.
 
     Returns
     -------
@@ -231,7 +233,8 @@ def _cstack(left, right):
         Result from this operation.
 
     """
-    noutp = _compute_n_outputs(left, right)
+    if noutp is None:
+        noutp = _compute_n_outputs(left, right)
 
     if isinstance(left, Model):
         cleft = _coord_matrix(left, 'left', noutp)
@@ -247,7 +250,7 @@ def _cstack(left, right):
     return np.hstack([cleft, cright])
 
 
-def _cdot(left, right):
+def _cdot(left, right, noutp=None):
     """
     Function corresponding to "|" operation.
 
@@ -255,6 +258,8 @@ def _cdot(left, right):
     ----------
     left, right : `astropy.modeling.Model` or ndarray
         If input is of an array, it is the output of `coord_matrix`.
+    noutp : int, optional
+        Number of outputs of the compound model.
 
     Returns
     -------
@@ -264,18 +269,21 @@ def _cdot(left, right):
 
     left, right = right, left
 
-    def _n_inputs_outputs(input, position):
+    def _n_inputs_outputs(input, position, noutp):
         """
         Return ``n_inputs``, ``n_outputs`` for a model or coord_matrix.
         """
         if isinstance(input, Model):
-            coords = _coord_matrix(input, position, input.n_outputs)
+            coords = _coord_matrix(input, position, noutp)
         else:
             coords = input
         return coords
 
-    cleft = _n_inputs_outputs(left, 'left')
-    cright = _n_inputs_outputs(right, 'right')
+    if noutp is None:
+        noutp = _compute_n_outputs(left, right)
+
+    cleft = _n_inputs_outputs(left, 'left', noutp)
+    cright = _n_inputs_outputs(right, 'right', noutp)
 
     try:
         result = np.dot(cleft, cright)
@@ -306,7 +314,7 @@ def _separable(transform):
     elif isinstance(transform, CompoundModel):
         sepleft = _separable(transform.left)
         sepright = _separable(transform.right)
-        return _operators[transform.op](sepleft, sepright)
+        return _operators[transform.op](sepleft, sepright, transform.n_outputs)
     elif isinstance(transform, Model):
         return _coord_matrix(transform, 'left', transform.n_outputs)
 
